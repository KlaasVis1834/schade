<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Meld uw schade bij Klaas Vis voor inboedel, opstal, aansprakelijkheid, motorvoertuig en meer.">
  <title>Schade Melden - Klaas Vis</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <link rel="icon" href="Logo.png" type="image/png">
  
  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  
  <script>
    (function() {
      try {
        emailjs.init("SLdpWo1ZAJkoOj75G"); // Jouw EmailJS Public Key
        console.log("EmailJS succesvol geïnitialiseerd");
      } catch (e) {
        console.error("EmailJS initialisatie mislukt:", e);
      }
    })();
  </script>

  <link rel="stylesheet" href="styles.css?v=1">
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="logo-container">
      <a href="https://www.klaasvis.nl" class="logo-link">
        <img src="Logo.png?v=2" alt="Klaas Vis Logo" class="main-logo">
      </a>
    </div>
    <nav class="nav">
      <button class="hamburger">☰</button>
      <ul class="nav-list">
        <li><a href="https://www.klaasvis.nl">Home</a></li>
        <li><a href="https://klaasvis1834.github.io/contact/">Doorgeven wijziging</a></li>
        <li><a href="https://dekkerautoverzekering.github.io/home/">Dekkerautoverzekering</a></li>
        <li><a href="https://www.nh1816.nl/mijn-nh1816">Mijn NH1816 Polis</a></li>
        <li><a href="https://www.klaasvis.nl/downloads">Downloads</a></li>
        <li><a href="https://klaasvis1834.github.io/contact/">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- Schade Melden -->
  <section id="schade-melden" class="schade-melden">
    <div class="schade-content">
      <h2>Schade Melden</h2>
      <p>Vul onderstaand formulier in om uw schade te melden voor inboedel, opstal, aansprakelijkheid, motorvoertuig of andere verzekeringen. Wij nemen zo spoedig mogelijk contact met u op.</p>

      <form id="schade-form" class="schade-form">
        <div class="form-group">
          <label for="name">Voorletter(s) en achternaam *</label>
          <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
          <label for="email">E-mailadres *</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="phone">Telefoonnummer</label>
          <input type="tel" id="phone" name="phone">
        </div>
        <div class="form-group">
          <label for="insurance">Type Verzekering *</label>
          <select id="insurance" name="insurance" required>
            <option value="" disabled selected>Kies een verzekering</option>
            <option value="inboedel">Inboedel</option>
            <option value="opstal">Opstal</option>
            <option value="aansprakelijkheid">Aansprakelijkheid</option>
            <option value="motorvoertuig">Motorvoertuig</option>
            <option value="reis">Reis en annulering</option>
            <option value="overig">Overig</option>
          </select>
        </div>
        <div class="form-group">
          <label for="polisnummer">Polisnummer *</label>
          <input type="text" id="polisnummer" name="polisnummer" required>
        </div>
        <div class="form-group">
          <label for="datum">Schadedatum *</label>
          <input type="date" id="datum" name="datum" required>
        </div>
        <div class="form-group">
          <label for="beschrijving">Beschrijving van de Schade *</label>
          <textarea id="beschrijving" name="beschrijving" rows="5" required></textarea>
        </div>

        <!-- ✅ reCAPTCHA -->
        <div class="form-group">
          <div class="g-recaptcha" data-sitekey="6LenGOArAAAAAIM8bxj3lEQAnguib5e1bHTl0XrM"></div>
        </div>

        <button type="submit" class="btn primary">Schade Melden</button>
      </form>

      <div id="form-message" class="form-message"></div>
    </div>
  </section>

  <!-- ✅ Script voor reCAPTCHA-beveiligd verzenden -->
  <script>
    document.getElementById('schade-form').addEventListener('submit', async function(event) {
      event.preventDefault();
      const form = this;
      const messageDiv = document.getElementById('form-message');
      const submitButton = form.querySelector('button[type="submit"]');
      
      // reCAPTCHA controle
      const recaptchaResponse = grecaptcha.getResponse();
      if (!recaptchaResponse) {
        messageDiv.textContent = '❗ Bevestig eerst dat u geen robot bent.';
        messageDiv.style.color = '#dc3545';
        return;
      }

      submitButton.disabled = true;
      messageDiv.textContent = 'Bezig met verzenden...';
      messageDiv.style.color = '#007bff';

      const formData = {
        name: form.name.value.trim(),
        email: form.email.value.trim(),
        phone: form.phone.value.trim() || 'Niet opgegeven',
        insurance: form.insurance.value,
        polisnummer: form.polisnummer.value.trim(),
        datum: form.datum.value,
        beschrijving: form.beschrijving.value.trim(),
        to_email: form.email.value
      };

      const message = `
Nieuwe schademelding ontvangen:

- Naam: ${formData.name}
- E-mail: ${formData.email}
- Telefoon: ${formData.phone}
- Verzekering: ${formData.insurance}
- Polisnummer: ${formData.polisnummer}
- Schadedatum: ${formData.datum}
- Beschrijving: ${formData.beschrijving}
      `;

      try {
        await emailjs.send('service_h6az3sj', 'template_naxxu2a', formData);
        await emailjs.send('service_h6az3sj', 'template_yqe7y7e', {
          to_email: 'mbuijs@klaasvis.nl',
          message: message
        });
        messageDiv.textContent = '✅ Schade succesvol gemeld! Wij nemen spoedig contact met u op.';
        messageDiv.style.color = '#28a745';
        form.reset();
        grecaptcha.reset();
      } catch (error) {
        console.error('EmailJS fout:', error);
        messageDiv.textContent = '❌ Fout bij verzenden. Probeer het later opnieuw.';
        messageDiv.style.color = '#dc3545';
      } finally {
        submitButton.disabled = false;
      }
    });
  </script>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p>© 2025 BV Assurantiekantoor Klaas Vis Ao. 1834 | Alle rechten voorbehouden</p>
    </div>
  </footer>
</body>
</html>
